<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Pitlite</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://jinta4020.github.io/"/>
  <updated>2020-03-01T23:55:14.752Z</updated>
  <id>https://jinta4020.github.io/</id>
  
  <author>
    <name>Jinta</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>vultr-scale-up</title>
    <link href="https://jinta4020.github.io/archives/vultr-scale-up/"/>
    <id>https://jinta4020.github.io/archives/vultr-scale-up/</id>
    <published>2020-03-01T23:55:14.752Z</published>
    <updated>2020-03-01T23:55:14.752Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>VPSでARKの新DLC、Genesisのサーバーを構築する</title>
    <link href="https://jinta4020.github.io/archives/ark-vps-setup/"/>
    <id>https://jinta4020.github.io/archives/ark-vps-setup/</id>
    <published>2020-02-26T07:30:00.000Z</published>
    <updated>2020-03-02T03:50:29.727Z</updated>
    
    <content type="html"><![CDATA[<p>2020年2月26日にARK:Survival Evolvedの新DLC、Genesisが発売しました。<br>Genesisをみんなで遊ぶためのサーバーを構築したので、そのログです。<br>サーバーをさわったことのない人も読むかもしれませんが、用語やコマンドやエディタ、ターミナルの操作方法などには、あまり詳しく言及していませんのでご注意ください。<br>構築自体はそこまで大変な作業ではないですが、バージョンや環境が違うとエラーが出ることもあり、またターミナル(サーバーを操作するソフト)の操作方法は独特で癖があるので、はじめてサーバーをさわる場合は、検索を繰り返して頑張る覚悟は必要です。</p><p>また、サーバーを構築する上で何かハマった場合はとりあえず、ARKのGamepediaにある<a href="https://ark.gamepedia.com/Dedicated_Server_Setup" target="_blank" rel="noopener">サーバー構築</a>と<a href="https://ark.gamepedia.com/Server_Configuration" target="_blank" rel="noopener">サーバー設定</a>の2ページの確認をおすすめします。(英語)</p><h3 id="バージョン情報"><a href="#バージョン情報" class="headerlink" title="バージョン情報"></a>バージョン情報</h3><table><thead><tr><th align="left">システム</th><th align="left">バージョン</th></tr></thead><tbody><tr><td align="left">OS</td><td align="left">Ubuntu 19.10 x64</td></tr></tbody></table><h3 id="VPSを選ぶ"><a href="#VPSを選ぶ" class="headerlink" title="VPSを選ぶ"></a>VPSを選ぶ</h3><p>ARKのサーバーには最低6GBのRAMと、64bitOSが必要です。<br>快適な動作を考えると、メモリは8GB程度確保したほうが無難だと思います。<br>それだけのメモリを使うとなると、海外VPSでないと予算が嵩みます。また、戦闘も多いARKではPingも重要なため、サーバーのロケーションはアジアにしておきたいです。<br>以上の理由から、VPSにはロケーションに東京を選べるVULTRを採用しました。<br>アカウントの登録と、paypalでの残高チャージの後、サーバーには「Cloud Compute」、OSには「Ubuntu」を選択、「IPv6」を有効に設定してデプロイしました。</p><p>8GBでGenesisのサーバーを動かしてみたところ、5人程度ならラグもあまりなくプレイできました。<br>それ以上の人数になるとラグが増えるかなという印象です。</p><h3 id="Ubuntuの初期設定"><a href="#Ubuntuの初期設定" class="headerlink" title="Ubuntuの初期設定"></a>Ubuntuの初期設定</h3><p>ARKのサーバー構築とは関係ありませんが、セキュリティ的にもセットアップ後の初期設定をやっておきます。<br>終わっている方は飛ばしてください。</p><h4 id="パッケージリストのアップデート"><a href="#パッケージリストのアップデート" class="headerlink" title="パッケージリストのアップデート"></a>パッケージリストのアップデート</h4><p>SSHでサーバーに接続後、まずは初回起動プロセスが動いている場合があるので、以下のコマンドで確認します。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># ps aux | grep apt | grep -v &#39;grep&#39;</span><br></pre></td></tr></table></figure><p>このコマンドを叩いても何もでてこなくなったら、まずはパッケージリストのアップデートをします。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># apt-get update &amp;&amp; apt-get upgrade</span><br></pre></td></tr></table></figure><p>Y/nを聞かれるので、確認後 <code>Y</code> を入力します。そこそこ時間がかかるのでのんびり待ちます。</p><h4 id="作業ユーザーと公開鍵認証の設定"><a href="#作業ユーザーと公開鍵認証の設定" class="headerlink" title="作業ユーザーと公開鍵認証の設定"></a>作業ユーザーと公開鍵認証の設定</h4><p>新規ユーザーを追加します。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># adduser &lt;作業ユーザー名&gt;</span><br></pre></td></tr></table></figure><p>パスワードを聞かれるので設定します。その後のユーザー情報は、Enter連打で問題ありません。<br>次にsudoグループに追加します。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># gpasswd -a &lt;作業ユーザー名&gt; sudo</span><br><span class="line"># su &lt;作業ユーザー名&gt;</span><br></pre></td></tr></table></figure><p>以降、すべての作業はsudoで行います。<br>まずは、ssh-keyを作成します。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-keygen -t ed25519 -C &quot;&lt;作業ユーザー名&gt;&#39;s key&quot;</span><br></pre></td></tr></table></figure><p>Keysの保存先を聞かれますが、そのままEnterを入力します。<br>秘密鍵用のパスワードを求められるので設定します。</p><p>次に、公開鍵を移動と、パーミッションの設定をします。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ cd ~&#x2F;.ssh&#x2F;</span><br><span class="line">$ cat id_ed25519.pub &gt;&gt; authorized_keys</span><br><span class="line">$ chmod 600 authorized_keys</span><br><span class="line">$ chmod 700 ~&#x2F;.ssh</span><br><span class="line">$ rm id_ed25519.pub</span><br></pre></td></tr></table></figure><p>次に秘密鍵を確認します。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cat id_ed25519</span><br></pre></td></tr></table></figure><p>ローカルのPCにid_ed25519というファイルを作成し、表示された内容をコピーします。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ rm id_ed25519</span><br></pre></td></tr></table></figure><p>コピー完了後、サーバーから秘密鍵を消去します。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ exit</span><br><span class="line"># exit</span><br></pre></td></tr></table></figure><p>いったん、サーバーへのSSH接続を終了します。<br>SSHクライアントで作業用のユーザー名・秘密鍵・パスフレーズを設定して、接続をテストします。<br>うまく接続できたら完了です。</p><h4 id="sshdの設定"><a href="#sshdの設定" class="headerlink" title="sshdの設定"></a>sshdの設定</h4><p>sshdの設定をします。vimでの編集方法は割愛します。<br>編集後、ssh接続をするときのポート番号が変更されますのでご注意ください。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo vim &#x2F;etc&#x2F;ssh&#x2F;sshd_config</span><br></pre></td></tr></table></figure><p>編集内容はこちらになります。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">-   #Port 22</span><br><span class="line">+   Port &lt;1024から49151の間のポート番号&gt;</span><br><span class="line"></span><br><span class="line">(中略)</span><br><span class="line"></span><br><span class="line">-   PermitRootLogin yes</span><br><span class="line">+   PermitRootLogin no</span><br><span class="line"></span><br><span class="line">(中略)</span><br><span class="line"></span><br><span class="line">-   #PasswordAuthentication yes</span><br><span class="line">+   PasswordAuthentication no</span><br><span class="line"></span><br><span class="line">(中略)</span><br><span class="line"></span><br><span class="line">-   UsePAM yes</span><br><span class="line">+   UsePAM no</span><br></pre></td></tr></table></figure><p>編集完了後、sshサービスを再起動します。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo service ssh restart</span><br></pre></td></tr></table></figure><h4 id="ファイアウォールのインストール"><a href="#ファイアウォールのインストール" class="headerlink" title="ファイアウォールのインストール"></a>ファイアウォールのインストール</h4><p>ファイアウォールをインストールと設定をします。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install ufw</span><br><span class="line">$ sudo vim &#x2F;etc&#x2F;default&#x2F;ufw</span><br></pre></td></tr></table></figure><p>編集内容はこちらになります。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-   IPV6&#x3D;yes</span><br><span class="line">+   IPV6&#x3D;no</span><br></pre></td></tr></table></figure><p>sshのポートと、ARKのサーバーに使うポートを解放します。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ sudo ufw allow &lt;sshのポート番号&gt;</span><br><span class="line">$ sudo ufw allow 27015&#x2F;udp</span><br><span class="line">$ sudo ufw allow 7777&#x2F;udp</span><br><span class="line">$ sudo ufw allow 7778&#x2F;udp</span><br><span class="line">$ sudo ufw default deny</span><br><span class="line">$ sudo ufw enable</span><br></pre></td></tr></table></figure><p>Y/nを聞かれるので、確認後 <code>Y</code> を入力します。<br>正しく設定できているか確認します。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo ufw status</span><br></pre></td></tr></table></figure><h4 id="再起動"><a href="#再起動" class="headerlink" title="再起動"></a>再起動</h4><p>最後に再起動をします。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo reboot</span><br></pre></td></tr></table></figure><h3 id="ARKサーバーの構築"><a href="#ARKサーバーの構築" class="headerlink" title="ARKサーバーの構築"></a>ARKサーバーの構築</h3><h4 id="SteamCmdのインストール"><a href="#SteamCmdのインストール" class="headerlink" title="SteamCmdのインストール"></a>SteamCmdのインストール</h4><p>SteamCmdは32Bitでないと動かないようなので、インストールします。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo dpkg --add-architecture i386</span><br><span class="line">$ sudo apt-get install lib32gcc1</span><br></pre></td></tr></table></figure><p>Y/nを聞かれるので、確認後 <code>Y</code> を入力します。<br>終了後、OSのアップデートとSteamCmdのインストールを行います。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get update</span><br><span class="line">$ sudo apt-get install steamcmd</span><br></pre></td></tr></table></figure><p>Y/nを聞かれるので、確認後 <code>Y</code> を入力します。<br>ライセンスが表示されるので、TABを押し、OKを選択して、Enterを押します。<br>I AGREEを選択して、Enterを押します。</p><h4 id="ファイルオープン数の上限の設定"><a href="#ファイルオープン数の上限の設定" class="headerlink" title="ファイルオープン数の上限の設定"></a>ファイルオープン数の上限の設定</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo vim &#x2F;etc&#x2F;sysctl.conf</span><br></pre></td></tr></table></figure><p>このファイルの最終行に、以下のテキストを追記します。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fs.file-max&#x3D;100000</span><br></pre></td></tr></table></figure><p>うまく設定できているか確認し、次にlimits.confを編集します。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo sysctl -p &#x2F;etc&#x2F;sysctl.conf</span><br><span class="line">$ sudo vim &#x2F;etc&#x2F;security&#x2F;limits.conf</span><br></pre></td></tr></table></figure><p><code># End of file</code> というコメントの前の行に、以下のテキストを追加します。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* soft nofile 1000000</span><br><span class="line">* hard nofile 1000000</span><br></pre></td></tr></table></figure><h4 id="pam-dのセッションファイルの編集"><a href="#pam-dのセッションファイルの編集" class="headerlink" title="pam.dのセッションファイルの編集"></a>pam.dのセッションファイルの編集</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo vim &#x2F;etc&#x2F;pam.d&#x2F;common-session</span><br></pre></td></tr></table></figure><p><code># end of pam-auth-update config</code> というコメントの前の行に、以下のテキストを追加します。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">session required pam_limits.so</span><br></pre></td></tr></table></figure><h4 id="ARKサーバーのインストールと設定"><a href="#ARKサーバーのインストールと設定" class="headerlink" title="ARKサーバーのインストールと設定"></a>ARKサーバーのインストールと設定</h4><p>ARKサーバー用のユーザーを作成しパスワードを設定します。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo adduser &lt;ARKユーザー名&gt;</span><br></pre></td></tr></table></figure><p>その後、ユーザーを変更し、ARKサーバー用のディレクトリを作成してインストールを行います。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ su &lt;ARKユーザー名&gt;</span><br><span class="line">$ cd ~</span><br><span class="line">$ mkdir ark</span><br><span class="line">$ &#x2F;usr&#x2F;games&#x2F;steamcmd +login anonymous +force_install_dir &#x2F;home&#x2F;&lt;ARKユーザー名&gt;&#x2F;ark +app_update 376030 +quit</span><br></pre></td></tr></table></figure><p>インストールにはかなりの時間がかかりますので、ゆっくり待ちます。<br>インストールが終了したら、作業ユーザーに戻り、ARKの設定ファイルを作成します。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ exit</span><br><span class="line">$ sudo vim &#x2F;lib&#x2F;systemd&#x2F;system&#x2F;ark.service</span><br></pre></td></tr></table></figure><p>以下のテキストをペーストします。<br>いくつか、自分で設定が必要な箇所がありますので、 <code>&lt;&gt;</code> で囲まれた箇所の書き換えは忘れないようにしてください。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[unit]</span><br><span class="line">Description&#x3D;ARK: Survival Evolved dedicated server</span><br><span class="line">Wants&#x3D;network-online.target</span><br><span class="line">After&#x3D;syslog.target network.target nss-lookup.target network-online.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type&#x3D;simple</span><br><span class="line">Restart&#x3D;on-failure</span><br><span class="line">RestartSec&#x3D;5</span><br><span class="line">StartLimitInterval&#x3D;60s</span><br><span class="line">StartLimitBurst&#x3D;3</span><br><span class="line">User&#x3D;&lt;ARKユーザー名&gt;</span><br><span class="line">Group&#x3D;&lt;ARKユーザー名&gt;</span><br><span class="line">ExecStartPre&#x3D;&#x2F;usr&#x2F;games&#x2F;steamcmd +login anonymous +force_install_dir &#x2F;home&#x2F;&lt;ARKユーザー名&gt;&#x2F;ark +app_update 376030 +quit</span><br><span class="line">ExecStart&#x3D;&#x2F;home&#x2F;&lt;ARKユーザー名&gt;&#x2F;ark&#x2F;ShooterGame&#x2F;Binaries&#x2F;Linux&#x2F;ShooterGameServer &lt;マップID&gt;?listen?SessionName&#x3D;&lt;サーバー名&gt;?MaxPlayers&#x3D;&lt;最大入室プレイヤー数&gt;?ServerPassword&#x3D;&lt;入室パスワード&gt;?ServerAdminPassword&#x3D;&lt;管理者パスワード&gt; -server -log</span><br><span class="line">LimitNOFILE&#x3D;100000</span><br><span class="line">WorkingDirectory&#x3D;&#x2F;home&#x2F;&lt;ARKユーザー名&gt;&#x2F;ark&#x2F;ShooterGame&#x2F;Binaries&#x2F;Linux</span><br><span class="line">ExecReload&#x3D;&#x2F;bin&#x2F;kill -s HUP $MAINPID</span><br><span class="line">ExecStop&#x3D;&#x2F;bin&#x2F;kill -s INT $MAINPID</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy&#x3D;multi-user.target</span><br></pre></td></tr></table></figure><p><code>&lt;ARKユーザー名&gt;</code> には、さきほど作成したARKユーザーの名前を設定します。<br><code>&lt;マップID&gt;</code> には、マップIDを設定します。ARKのGamepediaの<a href="https://ark.gamepedia.com/Server_Configuration" target="_blank" rel="noopener">サーバー設定</a>ページの、 <code>&lt;map_name&gt;</code> の項目に、マップIDのリストアップがありますので、参考にしてください。Genesisに設定したい場合は、 <code>Genesis</code> を設定します。<br><code>&lt;サーバー名&gt;</code> には、ARKのサーバーリストに表示されるサーバー名を設定します。<br><code>&lt;最大入室プレイヤー数&gt;</code> には、ARKのサーバーに入室できる最大人数を整数で設定します。<br><code>&lt;入室パスワード&gt;</code> には、ARKのサーバーに入室するためのパスワードを設定します。<br><code>&lt;管理者パスワード&gt;</code> には、ARKのチートコマンドなどを使用するためのパスワードを設定します。</p><p>最後に、systemctlの設定を行います。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo systemctl daemon-reload</span><br><span class="line">$ sudo systemctl enable ark.service</span><br><span class="line">$ sudo systemctl start ark</span><br></pre></td></tr></table></figure><p>これで、ARKのサーバーに接続できるはずです。</p><h3 id="ARKサーバーの運用"><a href="#ARKサーバーの運用" class="headerlink" title="ARKサーバーの運用"></a>ARKサーバーの運用</h3><h4 id="ARKサーバーへの接続手順"><a href="#ARKサーバーへの接続手順" class="headerlink" title="ARKサーバーへの接続手順"></a>ARKサーバーへの接続手順</h4><p>構築したサーバーに接続するためには、まず、Steamのゲームクライアントを起動します。<br>その後、メニューバーの「表示」→「サーバー」を選択し、お気に入りタブを選択します。<br>右下の「サーバーを追加」ボタンを押下し、 <code>&lt;VPSサーバーのIPアドレス&gt;:27015</code> を入力します。</p><p>次にARKのゲームを起動します。<br>セッション一覧の左下にある、セッションフィルターから「お気に入り」を選択すると、先ほど設定したサーバーがでてくるので、接続します。</p><p>一度接続すると、 <code>/home/&lt;ARKユーザー名&gt;/ark/ShooterGame</code> の中に、Savedディレクトリが生成されているはずですので、確認します。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo ls -l &#x2F;home&#x2F;&lt;ARKユーザー名&gt;&#x2F;ark&#x2F;ShooterGame</span><br></pre></td></tr></table></figure><p>できていなかった場合、arkディレクトリのパーミッション設定や、手順に抜けがある可能性がありますので、ご注意ください。</p><h4 id="ARKサーバーの設定変更"><a href="#ARKサーバーの設定変更" class="headerlink" title="ARKサーバーの設定変更"></a>ARKサーバーの設定変更</h4><p><code>/home/&lt;ARKユーザー名&gt;/ark/ShooterGame/Saved/Config/LinuxServer/GameUserSettings.ini</code><br><code>/home/&lt;ARKユーザー名&gt;/ark/ShooterGame/Saved/Config/LinuxServer/Game.ini</code><br>この2ファイルを編集することで、サーバーのテイム速度やPvP設定などを変更できます。<br>詳しくは、ARKのGamepediaの<a href="https://ark.gamepedia.com/Server_Configuration" target="_blank" rel="noopener">サーバー設定</a>ページを参考にしてください。<br>また編集後は、サーバーの再起動とステータスの確認を忘れないようにしましょう。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo reboot</span><br><span class="line">$ sudo systemctl status ark.service</span><br></pre></td></tr></table></figure><h4 id="筆者のサーバー設定"><a href="#筆者のサーバー設定" class="headerlink" title="筆者のサーバー設定"></a>筆者のサーバー設定</h4><p>参考までに、現在筆者がサーバーで使用している設定を掲載しておきます。</p><p><strong>GameUserSettings.ini</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[ServerSettings]</span><br><span class="line">serverPVE&#x3D;1</span><br><span class="line">EnablePVEGamma&#x3D;1</span><br><span class="line">allowThirdPersonPlayer&#x3D;1</span><br><span class="line">bAllowFlyerCarryPvE&#x3D;1</span><br><span class="line">bDisableStructureDecayPvE&#x3D;1</span><br><span class="line">globalVoiceChat&#x3D;0</span><br><span class="line">XPMultiplier&#x3D;30.00000</span><br><span class="line">HarvestAmountMultiplier&#x3D;4.00000</span><br><span class="line">PlayerCharacterHealthRecoveryMultiplier&#x3D;1.00000</span><br><span class="line">PlayerCharacterStaminaDrainMultiplier&#x3D;1.00000</span><br><span class="line">PlayerCharacterFoodDrainMultiplier&#x3D;1.00000</span><br><span class="line">PlayerCharacterWaterDrainMultiplier&#x3D;1.00000</span><br><span class="line">TamingSpeedMultiplier&#x3D;10.00000</span><br><span class="line">DifficultyOffset&#x3D;1.00000</span><br></pre></td></tr></table></figure><p><strong>Game.ini</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[&#x2F;script&#x2F;shootergame.shootergamemode]</span><br><span class="line">EggHatchSpeedMultiplier&#x3D;50.00000</span><br><span class="line">BabyMatureSpeedMultiplier&#x3D;50.00000</span><br><span class="line">BabyImprintingStatScaleMultiplier&#x3D;30.00000</span><br><span class="line">BabyCuddleIntervalMultiplier&#x3D;0.01000</span><br><span class="line">BabyCuddleGracePeriodMultiplier&#x3D;20.00000</span><br><span class="line">BabyCuddleLoseImprintQualitySpeedMultiplier&#x3D;0.00100</span><br><span class="line">BabyFoodConsumptionSpeedMultiplier&#x3D;0.10000</span><br></pre></td></tr></table></figure><p><strong>解説</strong><br>上から解説をしていきます。</p><ul><li>PvPオフ</li><li>PvEでのガンマ値の変更を許可</li><li>三人称視点可能</li><li>飛行恐竜で人間の持ち運び可能</li><li>PvEでの建築物の破壊タイマーをオフ</li><li>ボイスチャットオフ</li><li>経験値(XP)30倍</li><li>採取の収穫量4倍</li><li>プレイヤーのHP回復量1倍(通常)</li><li>プレイヤーのスタミナ消費量1倍(通常)</li><li>プレイヤーの食料消費量1倍(通常)</li><li>プレイヤーの水分消費量1倍(通常)</li><li>テイム速度10倍</li><li>難易度マックス (マックスにしないと、野生の恐竜の出現レベルが低くなるため、マックスにしています)</li><li>孵化/妊娠速度50倍</li><li>Babyの成長速度50倍</li><li>Babyのインプリントボーナス30倍</li><li>Babyのインプリント可能間隔0.01倍</li><li>Babyのインプリント猶予期間20倍</li><li>Babyのインプリントボーナス減少速度0.001倍</li><li>Babyの食料消費速度 0.1倍</li></ul><h3 id="ハマったエラー"><a href="#ハマったエラー" class="headerlink" title="ハマったエラー"></a>ハマったエラー</h3><h4 id="SteamAPI-Init-failed"><a href="#SteamAPI-Init-failed" class="headerlink" title="SteamAPI_Init() failed"></a>SteamAPI_Init() failed</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo systemctl status ark.service</span><br></pre></td></tr></table></figure><p>を実行すると、</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ShooterGameServer[997]: [S_API FAIL] SteamAPI_Init() failed; SteamAPI_IsSteamRunning() failed.</span><br><span class="line">ShooterGameServer[997]: Setting breakpad minidump AppID &#x3D; 346110</span><br></pre></td></tr></table></figure><p>というエラーメッセージがでてきますが、調べた限りでは、これは無視しても問題ないようです。</p><h4 id="error-while-loading-shared-libraries-libsteam-api-so"><a href="#error-while-loading-shared-libraries-libsteam-api-so" class="headerlink" title="error while loading shared libraries: libsteam_api.so:"></a>error while loading shared libraries: libsteam_api.so:</h4><p>Genesis発売日にサーバーを構築したところ、下のようなエラーメッセージがでました。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;ShooterGame&#x2F;Binaries&#x2F;Linux&#x2F;ShooterGameServer: error while loading shared libraries: libsteam_api.so: cannot open shared object file: No such file or directory</span><br></pre></td></tr></table></figure><p>どうやら、ARKのDLCリリース直後は、Linuxの個人サーバーに対応していないようです。</p><p><a href="https://survivetheark.com/index.php?/forums/topic/507564-genesis-dedicated-server-error/" target="_blank" rel="noopener">こちらのフォーラム</a>に解決方法がありました。<br>フォーラムに貼られたGoogleDriveから足りないファイルをダウンロードし、 <code>/home/&lt;ARKユーザー名&gt;/ark/Engine/Binaries/Linux</code> にすべてのファイルを転送し、転送したファイルのパーミッションを775に設定して再起動したところ、無事にエラーが解決しました。<br>ファイルのダウンロードなど、くれぐれも自己責任でお願いします。</p><h3 id="マップの変更"><a href="#マップの変更" class="headerlink" title="マップの変更"></a>マップの変更</h3><p>プレイするマップを変更したい場合は、</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo vim &#x2F;lib&#x2F;systemd&#x2F;system&#x2F;ark.service</span><br></pre></td></tr></table></figure><p>で、&lt;マップID&gt;を変更し、再起動します。<br>マップを変更した場合、プレイヤーキャラクターは引き継ぎますが、アイテムは引き継がないようです。(要確認)</p><h3 id="おわりに"><a href="#おわりに" class="headerlink" title="おわりに"></a>おわりに</h3><p>以上でARKのサーバー設定を終わります。<br>いつか気が向いたら、セーブデータのバックアップ方法や、Modなどについても追記したいと思います。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;2020年2月26日にARK:Survival Evolvedの新DLC、Genesisが発売しました。&lt;br&gt;Genesisをみんなで遊ぶためのサーバーを構築したので、そのログです。&lt;br&gt;サーバーをさわったことのない人も読むかもしれませんが、用語やコマンドやエディタ、タ
      
    
    </summary>
    
    
    
      <category term="ARK" scheme="https://jinta4020.github.io/tags/ARK/"/>
    
      <category term="Ubuntu" scheme="https://jinta4020.github.io/tags/Ubuntu/"/>
    
  </entry>
  
  <entry>
    <title>Hexo + GitHub Pagesでさくっとブログをつくる</title>
    <link href="https://jinta4020.github.io/archives/hexo/"/>
    <id>https://jinta4020.github.io/archives/hexo/</id>
    <published>2020-01-01T17:40:00.000Z</published>
    <updated>2020-01-02T16:20:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>静的Webサイトジェネレーター<a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>で技術のアウトプットをするためのブログをさくっとつくります。<br>デプロイはGitHub Pagesで行います。完成したものがこちらのブログです。<br>簡単な流れと、はまったところだけメモします。</p><h3 id="バージョン情報"><a href="#バージョン情報" class="headerlink" title="バージョン情報"></a>バージョン情報</h3><table><thead><tr><th align="left">システム</th><th align="left">バージョン</th></tr></thead><tbody><tr><td align="left">OS</td><td align="left">Windows 10 Home</td></tr><tr><td align="left">Node.js</td><td align="left">v12.11.0</td></tr><tr><td align="left">yarn</td><td align="left">1.19.0</td></tr><tr><td align="left">hexo</td><td align="left">4.0.0</td></tr></tbody></table><h3 id="Hexoを導入する"><a href="#Hexoを導入する" class="headerlink" title="Hexoを導入する"></a>Hexoを導入する</h3><p>Node.jsとnpmが導入されているなら、基本的には<a href="https://hexo.io/docs/" target="_blank" rel="noopener">公式ドキュメント</a>のとおりに導入するだけです。</p><h4 id="Themeを選ぶ"><a href="#Themeを選ぶ" class="headerlink" title="Themeを選ぶ"></a>Themeを選ぶ</h4><p>自分は<a href="https://hexo.io/themes/" target="_blank" rel="noopener">公式テーマライブラリ</a>で探しました。<br><a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank" rel="noopener">Chic</a>というテーマがシンプルで気に入ったのでこれに決定。README.mdを参考にして導入しました。</p><p>フォントが中国語になっていたので、cssファイルを編集して日本語のWebフォントに変更しました。</p><h4 id="テーマの設定"><a href="#テーマの設定" class="headerlink" title="テーマの設定"></a>テーマの設定</h4><p>ルートディレクトリの<br>テーマフォルダにある <code>_config.yml</code> を上書きして、タイトルなどを設定します。<br>ルートディレクトリの <code>_config.yml</code> に追加すると、キーが重複して</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FATAL duplicated mapping key at line *, column *:</span><br></pre></td></tr></table></figure><p>というエラーがでるのでご注意ください。</p><p>言語とタイムゾーンは日本のものに設定します。</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">language:</span> <span class="string">ja</span></span><br><span class="line"><span class="attr">timezone:</span> <span class="string">'Asia/Tokyo'</span></span><br></pre></td></tr></table></figure><p>その他、タイトル・メニューなども設定できます。<br>テーマ独自の設定項目もあります。テーマのREADME.mdを参考にしましょう。</p><h4 id="複数タグの設定方法"><a href="#複数タグの設定方法" class="headerlink" title="複数タグの設定方法"></a>複数タグの設定方法</h4><p>記事に複数のタグを設定したい場合は、</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">tags:</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">Hexo</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">Node.js</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">GitHub</span> <span class="string">Pages</span></span><br></pre></td></tr></table></figure><p>こういう記法で列挙しましょう。</p><h4 id="FEEDの導入"><a href="#FEEDの導入" class="headerlink" title="FEEDの導入"></a>FEEDの導入</h4><p>npmパッケージの <code>hexo-generator-feed</code> をインストールするだけで導入できました。</p><h4 id="更新日の設定"><a href="#更新日の設定" class="headerlink" title="更新日の設定"></a>更新日の設定</h4><p>記事ファイルのヘッダーに</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">updated:</span> <span class="number">2020</span><span class="number">-01</span><span class="number">-01</span> <span class="number">10</span><span class="string">:00:00</span></span><br></pre></td></tr></table></figure><p>という記述を追加すると、更新日が設定できます。</p><h4 id="Google-Analyticsの設定"><a href="#Google-Analyticsの設定" class="headerlink" title="Google Analyticsの設定"></a>Google Analyticsの設定</h4><p>モチベーションに繋がるので、Google Analyticsは導入したいところ。<br>テーマファイルのejsファイルに直接タグを追加しました。</p><h3 id="GitHub-Pagesでデプロイする"><a href="#GitHub-Pagesでデプロイする" class="headerlink" title="GitHub Pagesでデプロイする"></a>GitHub Pagesでデプロイする</h3><p>GitHub Pagesでのデプロイについても、<a href="https://hexo.io/docs/github-pages" target="_blank" rel="noopener">公式ドキュメント</a>が充実していたのでそちらの、 <strong>Private repository</strong> の項目を参考にしました。<br>ですが、GitHub Pagesのユーザーページにデプロイしたかったので、多少手順が変わっています。<br>( <code>https://&lt;username&gt;.github.io/&lt;project&gt;/</code> ではなく、 <code>https://&lt;username&gt;.github.io/</code> にデプロイしたかった)</p><ol><li><code>&lt;username&gt;.github.io</code> という空のリポジトリを作成します。(publicで作らないと無料でGitHub Pagesが使えないので注意)</li><li>ルートディレクトリの <code>_config.yml</code> に公式ドキュメントを参考に記述を追加し、branchをmasterに変更</li><li>ルートで <code>$ hexo clean</code> と <code>$ hexo deploy</code> を実行 (自分はnpm-run-allを導入して、1コマンドにまとめました)</li></ol><h3 id="おわりに"><a href="#おわりに" class="headerlink" title="おわりに"></a>おわりに</h3><p>テーマは、モチベーションのあるときに少しずつ改修するつもりなので、今後改修した内容はこちらに追記します。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;静的Webサイトジェネレーター&lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Hexo&lt;/a&gt;で技術のアウトプットをするためのブログをさくっとつくります。&lt;br&gt;デプロイはGitHub Pagesで行います
      
    
    </summary>
    
    
    
      <category term="Hexo" scheme="https://jinta4020.github.io/tags/Hexo/"/>
    
      <category term="Node.js" scheme="https://jinta4020.github.io/tags/Node-js/"/>
    
      <category term="GitHub Pages" scheme="https://jinta4020.github.io/tags/GitHub-Pages/"/>
    
  </entry>
  
</feed>
